!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("UIExtension"),require("UIExtension").PDFViewCtrl):"function"==typeof define&&define.amd?define(["UIExtension",["UIExtension","PDFViewCtrl"]],t):"object"==typeof exports?exports.HSingleViewModeAddon=t(require("UIExtension"),require("UIExtension").PDFViewCtrl):e.HSingleViewModeAddon=t(e.UIExtension,e.UIExtension.PDFViewCtrl)}(self,(e,t)=>(()=>{var n={622:e=>{e.exports=null},616:t=>{"use strict";t.exports=e},290:e=>{"use strict";e.exports=t}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return n[e](o,o.exports,i),o.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var o={};return(()=>{"use strict";function e(t){return e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e(t)}function t(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(t=function(){return!!e})()}function n(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}function r(r,i,o){return i=e(i),n(r,t()?Reflect.construct(i,o||[],e(r).constructor):i.apply(r,o))}function s(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):s(e,t)}function l(e,t){if(!s(e,t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function u(t,n,r){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,n,r){var i=function(t,n){for(;!Object.prototype.hasOwnProperty.call(t,n)&&null!==(t=e(t)););return t}(t,n);if(i){var o=Object.getOwnPropertyDescriptor(i,n);return o.get?o.get.call(r||t):o.value}},u(t,n,r||t)}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}i.d(o,{default:()=>P});var h=i(616),g=i(622),p=i.n(g),v=i(290),y=PDFViewCtrl.keyboard.BuiltinShortcutCommand,m=function(e){function t(){return l(this,t),r(this,t,arguments)}return f(t,e),c(t,[{key:"onKeyPressed",value:function(e){var t=this.getPDFDocRender();switch(e.command){case y.ARROW_LEFT:case y.ARROW_RIGHT:return this.viewMode.start(),!1;case y.JUMP_TO_FIRST_PAGE:return this.executor.exec(function(){return t.goToPage(0,{x:0,y:0})}),!1;case y.JUMP_TO_LAST_PAGE:var n=this.getPageCount(),r=n%2==0?n:n-1;return this.executor.exec(function(){return t.goToPage(r,{x:0,y:0})}),!0;case y.SCROLL_TO_NEXT_VISIBLE_AREA:return this.viewMode.toNext(),!0;case y.SCROLL_TO_PREVIOUS_VISIBLE_AREA:return this.viewMode.toPrev(),!0}return!1}},{key:"onKeyReleased",value:function(e){switch(e.command){case y.ARROW_LEFT:case y.ARROW_RIGHT:return this.viewMode.end(),!0}return!1}}]),t}(PDFViewCtrl.viewMode.ViewModeShortcutHandler),w=v.ViewerEvents,x=v.vendors,b=x.jQuery,R=x.Hammer,I=function(t){function n(e){var t;return l(this,n),(t=r(this,n,[e])).pdfViewer=e.pdfViewer,t.start=t.start.bind(t),t.end=t.end.bind(t),t.mousedown=t.mousedown.bind(t),t.mouseup=t.mouseup.bind(t),t.panning=!1,t.animating=!1,t.panType=null,t.scrollable=!1,t}return f(n,t),c(n,[{key:"getItems",value:function(){return this.docRender.$container.find(".fv__pdf-view-mode-item")}},{key:"disableScroll",value:function(){this.pdfViewer.eventEmitter.emit(w.disableScroll)}},{key:"enableScroll",value:function(){this.pdfViewer.eventEmitter.emit(w.enableScroll)}},{key:"into",value:function(t,r){var i=this;u(e(n.prototype),"into",this).call(this,t,r),this.disableScroll();var o=this.constructor.getName(),s=["<style>",".fv__pdf-viewer,.fv__pdf-viewer-layout,.fv__pdf-viewer-container,.fv__pdf-doc-layout{","height:100%;","}","."+o+"{","display:flex;","width:fit-content;","min-height:100%;","}","."+o+" .fv__pdf-view-mode-item{","display: -webkit-box;","display: -ms-flexbox;","display: -webkit-flex;","display: flex;","-ms-flex-pack: center;","-ms-flex-align: center;","-ms-justify-content: center;","-webkit-justify-content: center;","justify-content: center;","align-items:center;","}","."+o+" .fv__pdf-page-layout.fv__rendering{","min-width:128px;","}","</style>"].join("");this.$style=b(s),this.docRender.pagesRender.$ui.append(this.$style),this.docRender.$container.addClass(o),this.docRender.$ui.parents(".fv__ui-pdfviewer").css({"overflow-y":"unset","overflow-x":"scroll"});var l=this.pdfViewer.getStateHandlerManager();this.scrollable="hand"===l.getCurrentStates().getStateName(),this.pdfViewer.eventEmitter.on(w.switchStateHandler,this.switchSH=function(e){i.scrollable="hand"===e.getStateName(),i.disableScroll()});var a=this.docRender.viewerRender.scrollWrap;this.scrollHost=a.getScrollHost(),this.scrollHost.addEventListener("mousedown",this.mousedown),b(window).on("mouseup",this.mouseup),this.pdfViewer.eventEmitter.on(w.fitWidthResizeViewport,this.resize=function(){}),this.pdfViewer.eventEmitter.on(w.zoomToSuccess,this.zoom=function(){var e=i.docRender.getCurrentPageIndex();i.docRender.goToPage(e,{x:0,y:0})});var c=this.hammer=new R.Manager(this.scrollHost,{recognizers:[[R.Pan,{direction:R.DIRECTION_ALL}]]}),d=0,f=0;c.on("panstart",function(){if(i.scrollable){var e=i.allInVisible();i.leftIn=e.leftIn,i.rightIn=e.rightIn,i.panning=!0}}),c.on("panmove",function(e){if(i.scrollable&&i.panning&&!i.animating){var t=e.deltaX,n=e.deltaY,r=i.docRender.viewerRender.scrollWrap,o=r.getScrollLeft(),s=i.scrollHost.clientWidth+o,l=(r.getScrollTop(),i.docRender.getCurrentPageIndex()),a=i.getItems(),c=a.get(l).offsetLeft,u=c+a.eq(l).width(),h=d-t,g=f-n;d=t,f=n;var p=u-s,v=c-o;h>=0&&h>p&&(h=p),h<0&&h<v&&(h=v),r.scrollBy(h,g)}}),c.on("panend",function(){i.scrollable&&(1===i.panType?i.toNext():2===i.panType&&i.toPrev(),i.panning=!1,i.panType=null,d=0,f=0)}),c.on("panleft",function(){i.scrollable&&i.panning&&i.rightIn&&!i.animating&&(i.panType=1)}),c.on("panright",function(){i.scrollable&&i.panning&&i.leftIn&&!i.animating&&(i.panType=2)}),this._unwatchScrollEvent=a.addScrollEventListener(function(){clearTimeout(i.scrollEventTimer),i.scrollEventTimer=setTimeout(function(){var e=i.docRender.pagesRender;e&&e.renderVisiblePages().then(function(){i.docRender.setCurrentPageIndex(i.getCurrentPageIndex())},function(){})},30)})}},{key:"toNext",value:function(){var e=this.docRender.getCurrentPageIndex();this.animation(e+1,!1)}},{key:"toPrev",value:function(){var e=this.docRender.getCurrentPageIndex();this.animation(e-1,!0)}},{key:"animation",value:function(e,t){var n=this.docRender,r=n.doc.getPageCount();if(!(e<0||e>=r)){this.animating=!0;var i=n.viewerRender.scrollWrap,o=this.scrollHost.clientWidth,s=this.getItems(),l=s.get(e).offsetLeft,a=l+s.eq(e).width(),c=i.getScrollLeft(),u=i.getScrollTop(),d=t?-o:o,f=30,h=0;h=t?a-c:l-c,!t&&h>o&&(d=h),t&&h<0&&(d-=h);var g=d/f,p=this,v=setInterval(function(){f>0?(c+=g,i.scrollTo(c,u),f--):(clearInterval(v),p.animating=!1,n.setCurrentPageIndex(e))},10)}}},{key:"allInVisible",value:function(){var e=this.docRender.getCurrentPageIndex(),t=this.getItems(),n=this.docRender.viewerRender.scrollWrap,r=this.scrollHost.clientWidth,i=this.scrollHost.clientHeight,o=(n.getScrollTop(),n.getScrollLeft()),s=o+r,l=t.get(e).offsetLeft,a=l+t.eq(e).width(),c=!1,u=!1;return Math.abs(o-l)<=1&&(c=!0),Math.abs(s-a)<=1&&(u=!0),{leftIn:c,rightIn:u}}},{key:"renderViewMode",value:function(e,t,n,r,i){var o=e.index,s=this.getItems().eq(o),l=(this.docRender.pagesRender.$ui.height(),this.scrollHost),a=l.clientWidth,c=(l.clientHeight,s.find(".fv__pdf-page-layout").width());s.find(".fv__pdf-page-layout").height();c<a?s.css({width:a}):s.css({width:""})}},{key:"mousedown",value:function(e){var t=this.scrollHost,n=b(t).offset(),r=n.top,i=n.left,o=i+t.clientWidth,s=r+t.clientHeight;this.dragging=!0;var l=e.clientX,a=e.clientY;return this.scrollType=i<=l&&l<=o&&r<=a&&a<=s?0:o<l&&r<a?1:2,this.client={x:l,y:a},this.start(),!1}},{key:"mouseup",value:function(e){var t=this;t.dragging,t.client,t.panning;2===this.scrollType&&this.end()}},{key:"start",value:function(){this.scrollPageIndex=this.docRender.getCurrentPageIndex()}},{key:"end",value:function(){var e=this.getVisibleIndexes();if(1!==e.length){var t=e.indexOf(this.scrollPageIndex),n=e.length-1;t>-1?t<n/2?this.docRender.goToPage(e[n],{x:0,y:0}):this.docRender.goToPage(e[0],{x:0,y:0}):e[0]>t?this.docRender.goToPage(e[n],{x:0,y:0}):e[n]<t&&this.docRender.goToPage(e[0],{x:0,y:0})}}},{key:"prev",value:function(e){var t=this.getItems(),n=this.scrollHost.clientWidth,r=t.eq(e).width()-n;r>=1?this.jumpToPage(e,{x:r,y:0}):this.jumpToPage(e,{x:0,y:0})}},{key:"jumpToPage",value:function(e,t){var n=t.x,r=void 0===n?0:n,i=t.y,o=void 0===i?0:i,s=this.getItems();e>=s.length?e=s.length-1:e<0&&(e=0);var l=s[e],a=l.offsetLeft+r,c=l.offsetTop+o;this.docRender.viewerRender.scrollWrap.scrollTo(a,c)}},{key:"getCurrentPageIndex",value:function(){for(var e,t=this.docRender.$ui,n=this.getItems(),r=this.docRender.viewerRender.scrollWrap,i=(r.getScrollTop(),t.height(),r.getScrollLeft()),o=i+t.width(),s=[],l=0;l<n.length;l++){var a=n[l],c=a.offsetLeft,u=b(a).width(),d=c+u;c<=i&&d>i&&d<o?s.push({index:l,width:d-i}):c>=i&&d<o?s.push({index:l,width:u}):c<=i&&d>o?e=l:c>=i&&c<o&&d>o&&s.push({index:l,width:o-c})}if(null==e)for(var f=0,h=0;h<s.length;h++)s[h].width>f&&(f=s[h].width,e=s[h].index);return e}},{key:"getFitHeight",value:function(e){var t=this.docRender.viewerRender.scrollWrap;return t.getHeight()-t.getScrollOffsetTop()}},{key:"getFitWidth",value:function(e){var t=this.docRender.viewerRender.scrollWrap;return t.getWidth()-t.getScrollOffsetLeft()}},{key:"getVisibleIndexes",value:function(){var e=this.docRender.viewerRender.scrollWrap,t=e.getScrollLeft()-e.getScrollOffsetLeft(),n=this.docRender.$ui.width(),r=t+n,i=[];return this.getItems().each(function(e,n){var o=n.offsetLeft,s=n.offsetWidth+o;t<s&&r>o&&i.push(e)}),i}},{key:"getNextPageIndex",value:function(){var e=this.docRender.doc.getPageCount(),t=this.getCurrentPageIndex();return t<e-1&&t++,t}},{key:"getPrevPageIndex",value:function(){var e=this.getCurrentPageIndex();return e>0&&e--,e}},{key:"out",value:function(){this.enableScroll(),this.scrollable=!1,this.pdfViewer.eventEmitter.off(w.fitWidthResizeViewport,this.resize),this.scrollHost.removeEventListener("mousedown",this.mousedown),b(window).off("mouseup",this.mouseup),this.hammer.destroy(),this.pdfViewer.eventEmitter.off(w.fitWidthResizeViewport,this.resize),this.pdfViewer.eventEmitter.off(w.switchStateHandler,this.switchSH),this.pdfViewer.eventEmitter.off(w.zoomToSuccess,this.zoom),this.docRender.$container.removeClass(this.constructor.getName()),this.docRender.$ui.parents(".fv__ui-pdfviewer").css({"overflow-x":"","overflow-y":""}),this.$style&&this.$style.remove();for(var e=this.getItems(),t=0;t<e.length;t++)e.eq(t).css({width:""})}},{key:"generateShortcutEventHandler",value:function(){return new m(this)}}],[{key:"getName",value:function(){return"h-single-view-mode"}}]),n}(v.IViewMode),P=(h.Controller,h.PDFViewCtrl.Events,function(t){function n(){return l(this,n),r(this,n,arguments)}return f(n,t),c(n,[{key:"init",value:function(t,r){u(e(n.prototype),"init",this).call(this,t,r),r.getViewModeManager().register(I)}}],[{key:"getName",value:function(){return"h-single"}},{key:"getLoader",value:function(){return p()}},{key:"initOnLoad",value:function(){h.modular.module("h-single",[]).registerPreConfiguredComponent("h-single-button",{template:'\n            <xbutton @tooltip name="h-single-button" icon-class="fv__icon-toolbar-h-single-page">h-single:buttons.title</xbutton>\n            ',config:[{target:"h-single-button",tooltip:{title:"h-single:buttons.title"},callback:function(e){function t(e){return l(this,t),r(this,t,[e,I.getName()])}return f(t,e),t}(h.controllers.ViewModeController)}]})}}]),n}(h.UIXAddon))})(),o=o.default})());
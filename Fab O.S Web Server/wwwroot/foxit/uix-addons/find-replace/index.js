!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("UIExtension")):"function"==typeof define&&define.amd?define(["UIExtension"],t):"object"==typeof exports?exports.FindReplaceUIXAddon=t(require("UIExtension")):e.FindReplaceUIXAddon=t(e.UIExtension)}(self,e=>(()=>{var t={452:(e,t,n)=>{var i=n(779);e.exports=function(e){"use strict";var t="",n=(e=e||{}).tabindex,r=i.$escape;return t+='<layer name="find-replace-dialog" class="fv__ui-find-replace-dialog right top websdk-modal" @draggable="">\n<layer-header title="find-replace:dialog.title"></layer-header>\n',t+='\n\x3c!-- <i @aria:role="button" class="fv__ui-find-replace-icon-close p_a r_14 t_20" name="closeDialog" tabindex="0"></i> --\x3e\n<div class="fv_ui_dialog_body">\n<label class="d_f mb_9 p_r">\n<input class="h_28 pl_12 ptpb_5" type="text" name="findValue" style="padding-right: 76px;" data-i18n="[placeholder]find-replace:dialog.labels.find" tabindex="',t+=r(n=0),t+='"/>\n<div class="p_a w_72 h_24 r_6 t_1 d_f">\n\x3c!-- <xbutton icon-class="fv__icon-search-down" name="btnNext"></xbutton>\n<xbutton icon-class="fv__icon-search-down" style="transform: rotate(180deg)" name="btnPrev"></xbutton> --\x3e\n<dropdown name="dropdown-options" class="fv__ui-dropdown-hide-text" icon-class="fv__icon-search-setting" separate="false">\n<dropdown-button name="optWholeWords">find-replace:dialog.options.wholeWords</dropdown-button>\n<dropdown-button name="optCaseSensitive">find-replace:dialog.options.caseSensitive</dropdown-button>\n',t+='\n</dropdown>\n</div>\n</label>\n<div class="d_f ai_c jc_sb mb_12">\n<xbutton\nclass="fv__ui-dialog-button fv__ui-find-replace-dialog-button"\nname="btnPrev"\ndata-i18n="find-replace:dialog.findReplaceBtn.prev"\n></xbutton>\n<xbutton\nclass="fv__ui-dialog-button fv__ui-find-replace-dialog-button"\nname="btnNext"\ndata-i18n="find-replace:dialog.findReplaceBtn.next"\n></xbutton>\n</div>\n<div class="d_f ai_c jc_sb">\n<i class="icon-btn-arrow" name="arrowButton">find-replace:dialog.findReplaceBtn.replace</i>\n</div>\n<label class="d_f mt_12 mb_12" style="display: none;">\n<input class="h_28 pl_12 ptpb_5" type="text" name="replaceValue" data-i18n="[placeholder]find-replace:dialog.labels.replace" tabindex="',t+=r(n),t+='"/>\n</label>\n<div class="d_f ai_c jc_sb find-replace-box" style="display: none;">\n<xbutton\nclass="fv__ui-dialog-button replaceButton"\nname="Replace"\ndata-i18n="find-replace:dialog.findReplaceBtn.replace"\n></xbutton>\n<xbutton\nclass="fv__ui-dialog-button confirm-button"\nname="ReplaceAll"\ndata-i18n="find-replace:dialog.findReplaceBtn.replaceAll"\n></xbutton>\n</div>\n</div>\n</layer>'}},936:(e,t,n)=>{n(779);e.exports=function(e){"use strict";e=e||{};return'<layer name="find-replace-progress" class="fv__ui-find-replace-progress right bottom">\n<div class="find-replace-progress-body">\n<div><span>find-replace:dialog.progress.searchFor</span>&nbsp;&nbsp;<span name="currentPageIndex"></span>&nbsp;/&nbsp;<span name="totalPage"></span></div>\n<div class="find-replace-progressbar-border">\n<div class="find-replace-progresstext"></div>\n<div class="find-replace-progressbar-grey"></div>\n</div>\n<div>\n<a href="javascript: void 0" name="cancel">find-replace:dialog.progress.cancel</a>\n</div>\n</div>\n</layer>'}},157:e=>{e.exports=null},585:(e,t,n)=>{"use strict";
/*! art-template@runtime | https://github.com/aui/art-template */var i="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:{},r=Object.create(i),a=/["&'<>]/;function o(e){return"string"!=typeof e&&(e=null==e?"":"function"==typeof e?o(e.call(e)):JSON.stringify(e)),e}r.$escape=function(e){return function(e){var t=""+e,n=a.exec(t);if(!n)return e;var i="",r=void 0,o=void 0,l=void 0;for(r=n.index,o=0;r<t.length;r++){switch(t.charCodeAt(r)){case 34:l="&#34;";break;case 38:l="&#38;";break;case 39:l="&#39;";break;case 60:l="&#60;";break;case 62:l="&#62;";break;default:continue}o!==r&&(i+=t.substring(o,r)),o=r+1,i+=l}return o!==r?i+t.substring(o,r):i}(o(e))},r.$each=function(e,t){if(Array.isArray(e))for(var n=0,i=e.length;n<i;n++)t(e[n],n);else for(var r in e)t(e[r],r)},e.exports=r},779:(e,t,n)=>{"use strict";e.exports=n(585)},705:(e,t,n)=>{var i=n(639).Symbol;e.exports=i},932:e=>{e.exports=function(e,t){for(var n=-1,i=null==e?0:e.length,r=Array(i);++n<i;)r[n]=t(e[n],n,e);return r}},286:e=>{e.exports=function(e){return e.split("")}},848:e=>{e.exports=function(e,t,n,i){for(var r=e.length,a=n+(i?1:-1);i?a--:++a<r;)if(t(e[a],a,e))return a;return-1}},239:(e,t,n)=>{var i=n(705),r=n(607),a=n(333),o=i?i.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":o&&o in Object(e)?r(e):a(e)}},118:(e,t,n)=>{var i=n(848),r=n(722),a=n(351);e.exports=function(e,t,n){return t==t?a(e,t,n):i(e,r,n)}},722:e=>{e.exports=function(e){return e!=e}},259:e=>{e.exports=function(e,t,n){var i=-1,r=e.length;t<0&&(t=-t>r?0:r+t),(n=n>r?r:n)<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var a=Array(r);++i<r;)a[i]=e[i+t];return a}},531:(e,t,n)=>{var i=n(705),r=n(932),a=n(469),o=n(448),l=i?i.prototype:void 0,s=l?l.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(a(t))return r(t,e)+"";if(o(t))return s?s.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},561:(e,t,n)=>{var i=n(990),r=/^\s+/;e.exports=function(e){return e?e.slice(0,i(e)+1).replace(r,""):e}},180:(e,t,n)=>{var i=n(259);e.exports=function(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:i(e,t,n)}},512:(e,t,n)=>{var i=n(118);e.exports=function(e,t){for(var n=e.length;n--&&i(t,e[n],0)>-1;);return n}},817:(e,t,n)=>{var i=n(118);e.exports=function(e,t){for(var n=-1,r=e.length;++n<r&&i(t,e[n],0)>-1;);return n}},957:(e,t,n)=>{var i="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=i},607:(e,t,n)=>{var i=n(705),r=Object.prototype,a=r.hasOwnProperty,o=r.toString,l=i?i.toStringTag:void 0;e.exports=function(e){var t=a.call(e,l),n=e[l];try{e[l]=void 0;var i=!0}catch(e){}var r=o.call(e);return i&&(t?e[l]=n:delete e[l]),r}},689:e=>{var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return t.test(e)}},333:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},639:(e,t,n)=>{var i=n(957),r="object"==typeof self&&self&&self.Object===Object&&self,a=i||r||Function("return this")();e.exports=a},351:e=>{e.exports=function(e,t,n){for(var i=n-1,r=e.length;++i<r;)if(e[i]===t)return i;return-1}},140:(e,t,n)=>{var i=n(286),r=n(689),a=n(676);e.exports=function(e){return r(e)?a(e):i(e)}},990:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},676:e=>{var t="\\ud800-\\udfff",n="["+t+"]",i="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",r="\\ud83c[\\udffb-\\udfff]",a="[^"+t+"]",o="(?:\\ud83c[\\udde6-\\uddff]){2}",l="[\\ud800-\\udbff][\\udc00-\\udfff]",s="(?:"+i+"|"+r+")"+"?",c="[\\ufe0e\\ufe0f]?",u=c+s+("(?:\\u200d(?:"+[a,o,l].join("|")+")"+c+s+")*"),d="(?:"+[a+i+"?",i,o,l,n].join("|")+")",h=RegExp(r+"(?="+r+")|"+d+u,"g");e.exports=function(e){return e.match(h)||[]}},279:(e,t,n)=>{var i=n(218),r=n(771),a=n(841),o=Math.max,l=Math.min;e.exports=function(e,t,n){var s,c,u,d,h,p,f=0,g=!1,v=!1,b=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function m(t){var n=s,i=c;return s=c=void 0,f=t,d=e.apply(i,n)}function y(e){var n=e-p;return void 0===p||n>=t||n<0||v&&e-f>=u}function P(){var e=r();if(y(e))return $(e);h=setTimeout(P,function(e){var n=t-(e-p);return v?l(n,u-(e-f)):n}(e))}function $(e){return h=void 0,b&&s?m(e):(s=c=void 0,d)}function D(){var e=r(),n=y(e);if(s=arguments,c=this,p=e,n){if(void 0===h)return function(e){return f=e,h=setTimeout(P,t),g?m(e):d}(p);if(v)return clearTimeout(h),h=setTimeout(P,t),m(p)}return void 0===h&&(h=setTimeout(P,t)),d}return t=a(t)||0,i(n)&&(g=!!n.leading,u=(v="maxWait"in n)?o(a(n.maxWait)||0,t):u,b="trailing"in n?!!n.trailing:b),D.cancel=function(){void 0!==h&&clearTimeout(h),f=0,s=p=c=h=void 0},D.flush=function(){return void 0===h?d:$(r())},D}},469:e=>{var t=Array.isArray;e.exports=t},218:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},5:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},448:(e,t,n)=>{var i=n(239),r=n(5);e.exports=function(e){return"symbol"==typeof e||r(e)&&"[object Symbol]"==i(e)}},771:(e,t,n)=>{var i=n(639);e.exports=function(){return i.Date.now()}},493:(e,t,n)=>{var i=n(279),r=n(218);e.exports=function(e,t,n){var a=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return r(n)&&(a="leading"in n?!!n.leading:a,o="trailing"in n?!!n.trailing:o),i(e,t,{leading:a,maxWait:t,trailing:o})}},841:(e,t,n)=>{var i=n(561),r=n(218),a=n(448),o=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,s=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(a(e))return NaN;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=i(e);var n=l.test(e);return n||s.test(e)?c(e.slice(2),n?2:8):o.test(e)?NaN:+e}},833:(e,t,n)=>{var i=n(531);e.exports=function(e){return null==e?"":i(e)}},742:(e,t,n)=>{var i=n(531),r=n(561),a=n(180),o=n(512),l=n(817),s=n(140),c=n(833);e.exports=function(e,t,n){if((e=c(e))&&(n||void 0===t))return r(e);if(!e||!(t=i(t)))return e;var u=s(e),d=s(t),h=l(u,d),p=o(u,d)+1;return a(u,h,p).join("")}},616:t=>{"use strict";t.exports=e}},n={};function i(e){var r=n[e];if(void 0!==r)return r.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,i),a.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r={};return(()=>{"use strict";function e(e,t,n,i,r,a,o){try{var l=e[a](o),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(i,r)}function t(t){return function(){var n=this,i=arguments;return new Promise(function(r,a){var o=t.apply(n,i);function l(t){e(o,r,a,l,s,"next",t)}function s(t){e(o,r,a,l,s,"throw",t)}l(void 0)})}}function n(e){return n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(e)}function a(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(a=function(){return!!e})()}function o(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}function l(e,t,i){return t=n(t),o(e,a()?Reflect.construct(t,i||[],n(e).constructor):t.apply(e,i))}function s(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):s(e,t)}function c(e,t){if(!s(e,t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function d(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function v(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}function b(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}i.d(r,{default:()=>M});function m(e,t){var n,i,r,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(a=0)),a;)try{if(n=1,i&&(r=2&l[0]?i.return:l[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,l[1])).done)return r;switch(i=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,i=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){a=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){a.label=l[1];break}if(6===l[0]&&a.label<r[1]){a.label=r[1],r=l;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(l);break}r[2]&&a.ops.pop(),a.trys.pop();continue}l=t.call(e,a)}catch(e){l=[6,e],i=0}finally{n=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError;var y=i(616),P=i(157),$=i.n(P);function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(i=n.next()).done)&&(a.push(i.value),!t||a.length!==t);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return a}}(e,t)||v(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}y.PDFViewCtrl.Consts.PDFDocPermission;var w=function(e){function t(e){var n;return c(this,t),(n=l(this,t,[e])).stateName="find-replace",n}return f(t,e),d(t,[{key:"handle",value:function(){var e=this.getPDFUI();setTimeout(function(){e.eventEmitter.emit("active-find-replace")},400)}},{key:"changePermission",value:function(e){var t=this;this.getPDFUI().getPDFDocRender().then(function(n){Promise.all([n&&n.getUserPermission().getValue(),e.isXFA(),e.readonly()]).then(function(n){var i=D(n,3),r=i[0],a=i[1];!i[2]&&r&t.constructor.permission?a?e.isStaticXFA()?t.component.unlock():t.component.lock():t.component.unlock():t.component.lock()})})}}],[{key:"getName",value:function(){return"FindReplaceController"}},{key:"permission",get:function(){return y.PDFViewCtrl.Consts.PDFDocPermission.ModifyDocument}}]),t}(y.Controller);const R={name:"find-replace-button",fragment:{template:'<ribbon-button @tooltip name="find-replace" icon-class="fv__icon-edit-find-replace"></ribbon-button>',config:{target:"find-replace",callback:w,attrs:{"tooltip-title":"toolbar.tooltip.find-replace.title"}}}};var F=i(452),x=i.n(F),k=i(742),I=i.n(k),A=i(493),C=i.n(A),S=UIExtension.vendors.jQuery,U=PDFViewCtrl.ViewerEvents,_=window.UIExtension.UIEvents,V=UIExtension.PDFViewCtrl.shared.createDeferred,O=!1,E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise(function(t){setTimeout(function(){t()},e)})},T=function(){function e(t,n){c(this,e),this.PDFUI=t,this.addon=n}return d(e,[{key:"initDialog",value:function(){arguments.length>0&&void 0!==arguments[0]||this.PDFUI;var e=x()();this.dialog=this.PDFUI.parseTemplate(e),this.dialog.localize(),this.dialog.mounted(),this.$dialog=S(this.dialog.element),this.$closeDialog=S("[name=closeDialog]",this.$dialog),this.$findValue=S("input[name=findValue]",this.$dialog),this.$replaceValue=S("input[name=replaceValue]",this.$dialog),this.$replace=S("[name=Replace]",this.$dialog),this.$replaceAll=S("[name=ReplaceAll]",this.$dialog),this.$btnNext=S("[name=btnNext]",this.$dialog),this.$btnPrev=S("[name=btnPrev]",this.$dialog),this.$optWholeWords=S("[name=optWholeWords]",this.$dialog),this.$optCaseSensitive=S("[name=optCaseSensitive]",this.$dialog),this.$optIncludePageText=S("[name=optIncludePageText]",this.$dialog),this.$optIncludeBookmarks=S("[name=optIncludeBookmarks]",this.$dialog),this.$optIncludeComments=S("[name=optIncludeComments]",this.$dialog),this.$optHighlight=S("[name=optHighlight]",this.$dialog),this.$optProperties=S("[name=optProperties]",this.$dialog),this.$arrowButton=S("[name=arrowButton]",this.$dialog),this.pageRange=null,this.findOption=0,this.isFound=!1,this.isFirst=!0,this.lastFoundPage=-1,this.isReplaceAll=!1,this.waitTouchupLoad=null,this.bindEvent()}},{key:"setLoaded",value:function(){this.waitTouchupLoad&&this.waitTouchupLoad.resolve()}},{key:"setFindingDisable",value:function(){return!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?([this.$replace,this.$replaceAll,this.$btnNext,this.$btnPrev,this.$findValue,this.$replaceValue].forEach(function(e){return e.attr("disabled",!0)}),Promise.resolve()):([this.$findValue,this.$replaceValue].forEach(function(e){return e.removeAttr("disabled")}),this.updateEleStatus())}},{key:"resetForm",value:function(){this.isFirst=!0,this.lastFoundPage=-1,this.pageRange=null,this.setOption(0),this.waitTouchupLoad=V(),this.resetReplaceBtn(),this.$findValue.val(""),this.$replaceValue.val(""),[this.$btnNext,this.$btnPrev,this.$replace,this.$replaceAll].forEach(function(e){return e.attr("disabled",!0)})}},{key:"resetReplaceBtn",value:function(){this.$replace.html(this.PDFUI.i18n.t("find-replace:dialog.findReplaceBtn.replace"))}},{key:"switchTouchup",value:function(){var e=this;return this.PDFUI.getStateHandlerManager().then(function(t){var n=t.getCurrentStates();return"touch-up-editor"!==n.getStateName()?(e.PDFUI.pdfViewer.eventEmitter.emit("switch-touchup",{type:"findReplace"}),e.waitTouchupLoad.promise.then(function(){return E()})):n.getType&&"findReplace"!==n.getType()?(e.PDFUI.pdfViewer.eventEmitter.emit("switch-touchup",{type:"findReplace"}),E()):Promise.resolve()})}},{key:"updateEleStatus",value:function(){var e=this,t=this.PDFUI.pdfViewer.getPDFDocRender().getPDFDoc().isOwner();return this.PDFUI.getCurrentPDFDoc().then(function(n){return n.isPdfaDoc().then(function(i){i&&!n.pdfaEditable?(e.$replace.attr("disabled",!0),e.$replaceAll.attr("disabled",!0)):(I()(e.$findValue.val()).length?(e.$btnNext.removeAttr("disabled"),e.$btnPrev.removeAttr("disabled")):(e.$btnNext.attr("disabled",!0),e.$btnPrev.attr("disabled",!0)),I()(e.$findValue.val()).length&&e.$replaceValue.val().length&&t?(e.$replace.removeAttr("disabled"),e.$replaceAll.removeAttr("disabled")):(e.$replace.attr("disabled",!0),e.$replaceAll.attr("disabled",!0)))})})}},{key:"onInput",value:function(){this.resetFindPostion(),this.updateEleStatus(),this.clearCache(),this.resetSearchCompStatus(),this.resetReplaceBtn()}},{key:"resetSearchCompStatus",value:function(){return t(function(){var e,t;return m(this,function(n){switch(n.label){case 0:return[4,this.PDFUI.getComponentByName("fv--search-input-input")];case 1:return null==(t=n.sent())||null===(e=t.parent)||void 0===e||e.searchMgr.clearResult(),[2]}})}).call(this)}},{key:"hide",value:function(){this.dialog&&(this.interrupt(),this.dialog.isVisible&&(this.dialog.hide(),this.addon.onHide(),this.PDFUI.eventEmitter.emit(U.findReplaceDialogVisibleChange,!1)))}},{key:"updateProtectedViewState",value:function(e){var t=!1;e&&"boolean"==typeof e?t=e:t="all"===(localStorage.getItem("SECURITY_PROTECTED_VIEW")||"off");var n=document.querySelector(".find-replace-box");n&&(t&&n.classList.add("disable-cus"),!t&&n.classList.remove("disable-cus"))}},{key:"bindEvent",value:function(){var e=this,t=this,n=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.resetReplaceBtn(),t.doFind(e).then(function(e){return e.isFound||n||t.PDFUI.alert("find-replace:dialog.notFound",void 0,void 0,"prompt"),t.isFirst=!1,e})};[this.$findValue,this.$replaceValue].forEach(function(e){return e.on("keydown",function(e){return e.stopPropagation(),!0})}),this.$findValue.on("input",C()(this.onInput.bind(this),500)),this.$replaceValue.on("input",C()(function(){e.resetFindPostion(),e.updateEleStatus()},500)),O=this.getAgainData(),this.findHandler=function(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];var a=D(i,3),o=a[0],l=a[1],s=a[2];return t.$findValue.val(o),t.pageRange=l,t.setOption(s),n(!(4&s),!0)},this.replaceHandler=function(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];var a=!1,o=!1;if(i.length>1){var l=D(i,4),s=l[0],c=l[1],u=l[2],d=l[3];t.$findValue.val(s),t.pageRange=u,t.$replaceValue.val(c),t.setOption(d),o=!(4&d),a=!0}var h=t.$findValue.val(),p=t.$replaceValue.val(),f=Promise.resolve(),g=t.PDFUI.i18n.t("find-replace:dialog.findReplaceBtn.replaceNext");return t.isFound?t.$replace.html()==g?f=n(o,a):a&&(t.clearCacheHandler(),f=n(o,a)):f=n(o,a),f.then(function(e){return t.isFound?a&&"function"==typeof t.addon.needToReplace?t.addon.needToReplace(h,p,e.pageIndex,e.rectArray).then(function(e){return e?t.doReplace()?1:2:(t.isFound=!1,Promise.resolve(3))}):t.doReplace()?1:2:Promise.resolve(0)}).then(function(e){return t.$replace.html(g),e}).catch(function(e){if(a)return Promise.reject(4)})},this.replaceAllHandler=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var r;if(n.length>1){var a=D(n,4),o=a[0],l=a[1],s=a[2],c=a[3];return t.$findValue.val(o),t.$replaceValue.val(l),t.pageRange=s,t.setOption(c),t.doReplaceAllAPI()}if(r=n[0],O)return t.doReplaceAll(r);t.PDFUI.customs.onShowWarningMessage?t.PDFUI.customs.onShowWarningMessage(function(e,n){if(n&&n.checked&&(O=!0),e)return t.doReplaceAll(r)},{title:t.PDFUI.i18n.t("sidebar.signature.dialog.title"),message:t.PDFUI.i18n.t("find-replace:dialog.replaceAllConfirm"),checkbox:{title:t.PDFUI.i18n.t("find-replace:dialog.DoNotShowAgain"),checked:!1},isI18n:!1}):t.PDFUI.$confirm({message:t.PDFUI.i18n.t("find-replace:dialog.replaceAllConfirm"),level:"warning",id:"find-replace-all",again:!0,againText:t.PDFUI.i18n.t("find-replace:dialog.DoNotShowAgain"),againCallback:function(e){O=e}}).then(function(){t.doReplaceAll(r)},function(){})},this.clearCacheHandler=function(){e.resetFindPostion(),e.clearCache(),e.isFound=!1},this.$replace.on("click",this.replaceHandler),this.$replaceAll.on("click",function(t,n){e.replaceAllHandler(n)}),this.$closeDialog.on("click",function(){e.hide()}),this.$btnNext.on("click",function(){e.$arrowButton.hasClass("show")?n():e.callSearchAddon("search",!0)}),this.$btnPrev.on("click",function(){e.$arrowButton.hasClass("show")?n(!0):e.callSearchAddon("search",!1)}),this.$optCaseSensitive.on("click",function(t){2&e.findOption?e.setOption(e.findOption&-3>>>0):e.setOption(2|e.findOption),e.clearCache(),e.isFound=!1,t.stopPropagation(),t.preventDefault()}),this.$optWholeWords.on("click",function(t){1&e.findOption?e.setOption(e.findOption&-2>>>0):e.setOption(1|e.findOption),e.clearCache(),e.isFound=!1,t.stopPropagation(),t.preventDefault()}),this.$optIncludePageText.on("click",function(){void 0!==e.$optIncludePageText.attr("checked")?e.$optIncludePageText.removeAttr("checked"):e.$optIncludePageText.attr("checked",!0),e.clearCache(),e.callSearchAddon("clearCache")}),this.$optIncludeBookmarks.on("click",function(){void 0!==e.$optIncludeBookmarks.attr("checked")?e.$optIncludeBookmarks.removeAttr("checked"):e.$optIncludeBookmarks.attr("checked",!0),e.clearCache(),e.callSearchAddon("clearCache")}),this.$optIncludeComments.on("click",function(){void 0!==e.$optIncludeComments.attr("checked")?e.$optIncludeComments.removeAttr("checked"):e.$optIncludeComments.attr("checked",!0),e.clearCache(),e.callSearchAddon("clearCache")}),this.$optHighlight.on("click",function(){void 0!==e.$optHighlight.attr("checked")?e.$optHighlight.removeAttr("checked"):e.$optHighlight.attr("checked",!0)}),this.$optProperties.on("click",function(){e.PDFUI.getComponentByName("fv--search-prop-dialog").then(function(t){return t||e.PDFUI.getComponentByName("template-container").then(function(e){return e.append('<search:search-prop-dialog name="fv--search-prop-dialog"></search:search-prop-dialog>')}).then(function(){return e.PDFUI.getComponentByName("fv--search-prop-dialog")})}).then(function(e){return e.show()})}),this.$arrowButton.on("click",function(){e.toggleReplaceButtons()}),this.PDFUI.eventEmitter.on("isProtectedView",this.updateProtectedViewState),this.PDFUI.addViewerEventListener(U.openFileSuccess,this.updateProtectedViewState);var i=new ResizeObserver(function(){setTimeout(function(){e.goView()},400)}),r=document.querySelector(".fv__ui-portfolio-container");r&&i.observe(r),this.PDFUI.addViewerEventListener(h({},_.sideBarChanged,function(){e.setDialogPosition()}))}},{key:"toggleReplaceButtons",value:function(e){var t=this.$arrowButton.hasClass("show");void 0===e&&(e=!t),e?(this.$arrowButton.addClass("show"),this.$arrowButton.parent().nextAll().show()):(this.$arrowButton.removeClass("show"),this.$arrowButton.parent().nextAll().hide()),this.$optCaseSensitive.nextAll().not(".fv__ui-dropdown-separator, [name=optProperties]").toggle(!e)}},{key:"callSearchAddon",value:function(e,n){return t(function(){var t,i,r;return m(this,function(a){switch(a.label){case 0:return console.log("==callSearchAddon==="),[4,this.PDFUI.getComponentByName("fv--search-input-input")];case 1:if(t=a.sent(),i=null==t?void 0:t.parent,!t||!i)return[2];if("clearCache"===e)return[2,i.searchMgr.clearResult()];for(var o in r={searchText:this.$findValue.val(),wholeWordsOnly:void 0!==this.$optWholeWords.attr("checked"),caseSensitive:void 0!==this.$optCaseSensitive.attr("checked"),includePageText:void 0!==this.$optIncludePageText.attr("checked"),includeBookmarks:void 0!==this.$optIncludeBookmarks.attr("checked"),includeComments:void 0!==this.$optIncludeComments.attr("checked"),highlightAll:void 0!==this.$optHighlight.attr("checked")})i.state[o]=r[o];return i.store.digest(),n?i.handleNext():i.handlePrev(),[2]}})}).call(this)}},{key:"getAgainData",value:function(){var e=localStorage.getItem("CONFIRM-AGAIN-DATA"),t=!1;return(e=e?JSON.parse(e):{})["find-replace-all"]&&(t=!0),t}},{key:"setDialogPosition",value:function(){var e=S(this.PDFUI.viewerFactory.wrapperElement);this.position(e)}},{key:"goto",value:function(e,n,i){return t(function(){var t;return m(this,function(r){switch(r.label){case 0:return this.isReplaceAll?[2]:[4,this.PDFUI.getPDFPageRender(e)];case 1:return(t=r.sent()).isRendered?[3,4]:[4,t.render(t.pagesRender.getPageScaleSync(e,t.docRender.getScale()))];case 2:return r.sent(),[4,t.waitRendered()];case 3:r.sent(),r.label=4;case 4:return this.PDFUI.goToPage(e,n,i),[2]}})}).call(this)}},{key:"waitPagesRender",value:function(e){return t(function(){var t,n;return m(this,function(i){switch(i.label){case 0:t=0,i.label=1;case 1:return t<=e?[4,this.PDFUI.getPDFPageRender(t)]:[3,6];case 2:return(n=i.sent()).isRendered?[3,5]:[4,n.render()];case 3:return i.sent(),[4,n.waitRendered()];case 4:i.sent(),i.label=5;case 5:return t++,[3,1];case 6:return[2]}})}).call(this)}},{key:"doFind",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t(function(){var t,i,r,a,o,l,s,c,u,d,h,p;return m(this,function(f){switch(f.label){case 0:return[4,this.switchTouchup()];case 1:return f.sent(),[4,this.PDFUI.getCurrentPDFDoc()];case 2:return t=f.sent(),o=t.getPageCount(),this.pageRange?-1==this.lastFoundPage?[3,4]:[4,Promise.all([this.PDFUI.getPDFDocRender().then(function(e){return e.getCurrentPageIndex()})])]:[3,6];case 3:return l=D.apply(void 0,[f.sent(),1]),a=l[0],[3,5];case 4:a=e?this.pageRange[1]:this.pageRange[0],f.label=5;case 5:return o=this.pageRange[1]+1,i=this.pageRange[0],r=this.pageRange[1],[3,8];case 6:return[4,Promise.all([this.PDFUI.getPDFDocRender().then(function(e){return e.getCurrentPageIndex()})])];case 7:s=D.apply(void 0,[f.sent(),1]),a=s[0],i=0,r=o-1,f.label=8;case 8:for(this.lastFoundPage>=i&&(a=this.lastFoundPage),c={},u=i;u<=r;u++)c[u]=!1;return d=void 0,this.dialog.hasFocus()&&(d=document.activeElement),n&&this.setFindingDisable(!0),[4,this.find(t,a,e)];case 9:h=f.sent(),c[a]=!0,p=a,f.label=10;case 10:return h.isFound||Object.values(c).every(function(e){return e})?[3,12]:((p=e?p-1:p+1)<i&&(p=r),p>=o&&(p=i),c[p]?[3,12]:[4,this.find(t,p,e)]);case 11:return h=f.sent(),c[p]=!0,[3,10];case 12:return h.isFound&&(this.lastFoundPage=p),n&&this.setFindingDisable(!1).finally(function(){d&&d.focus()}),h.isFound&&this.goView(),[2,h]}})}).call(this)}},{key:"goView",value:function(){var e=document.querySelector(".touchup_rect");e&&e.scrollIntoView()}},{key:"clearCache",value:function(){return this.PDFUI.getCurrentPDFDoc().then(function(e){return e.getTouchup().handleFindReplaceEvent("ClearCache")})}},{key:"interrupt",value:function(){return this.PDFUI.getCurrentPDFDoc().then(function(e){if(e)return e.getTouchup().handleFindReplaceEvent("InterruptProcess")})}},{key:"find",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t(function(){var t;return m(this,function(r){switch(r.label){case 0:return[4,e.getTouchup().handleFindReplaceEvent("Find",{type:"WString",value:this.$findValue.val()},n,{type:"FindOption",value:this.findOption|(i?0:4)})];case 1:return t=r.sent(),this.isFound=t.isFound,[2,t]}})}).call(this)}},{key:"doReplace",value:function(){var e=this;return this.PDFUI.getCurrentPDFDoc().then(function(t){e.isFound=!1;var n=e.$replaceValue.val();return t.getTouchup().handleFindReplaceEvent("Replace",{type:"WString",value:n})}).then(function(t){return e.addon.doReplace(),t})}},{key:"doReplaceAll",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isReplaceAll=!0,this.setFindingDisable(!0);var n=this.PDFUI.loading(),i=this.PDFUI.pdfViewer.getPDFDocRender().getCurrentPageIndex();return this.clearCache().then(function(){return e.switchTouchup()}).then(function(){return e.PDFUI.getCurrentPDFDoc()}).then(function(t){var n=e.$findValue.val(),r=e.$replaceValue.val();return t.getTouchup().handleFindReplaceEvent("ReplaceAll",{type:"WString",value:n},{type:"FindOption",value:e.findOption},{type:"WString",value:r},i)}).then(function(n){var i=e.PDFUI;if(n>0){var r=i.i18n.t("find-replace:dialog.replaceAllComplete",{count:n});!t&&i.alert(r,void 0,void 0,"prompt")}else{var a=i.i18n.t("find-replace:dialog.replaceAllNotFound")+e.$findValue.val();!t&&i.alert(a,void 0,void 0,"prompt")}return n}).then(function(t){return e.addon.doReplace(),t}).finally(function(){e.isReplaceAll=!1,e.setFindingDisable(!1),n.then(function(e){return e.close()}),t&&e.PDFUI.getComponentByName("sidebar-right-tabs").then(function(e){e.openTabs.includes("right-ai-panel")&&e.setActivetab("right-ai-panel")})})}},{key:"doReplaceAllAPI",value:function(){return t(function(){var e,n,i,r,a,o,l,s,c,u,d,h;return m(this,function(p){switch(p.label){case 0:return e=this,n=this.PDFUI.loading(),this.isReplaceAll=!0,this.setFindingDisable(!0),[4,this.clearCache()];case 1:return p.sent(),[4,this.switchTouchup()];case 2:return p.sent(),[4,this.PDFUI.getCurrentPDFDoc()];case 3:i=p.sent(),r=this.$findValue.val(),a=this.$replaceValue.val(),o=i.getTouchup(),l=0,s=function(n){return t(function(){var e;return m(this,function(t){switch(t.label){case 0:return[4,this.find(i,n)];case 1:return(e=t.sent()).isFound?"function"!=typeof this.addon.needToReplace?[3,5]:[4,this.addon.needToReplace(r,a,e.pageIndex,e.rectArray)]:[3,8];case 2:return t.sent()?[4,c()]:[3,4];case 3:t.sent(),l++,t.label=4;case 4:return[3,7];case 5:return[4,c()];case 6:t.sent(),l++,t.label=7;case 7:return[3,9];case 8:return[3,10];case 9:return[3,0];case 10:return[2]}})}).call(e)},c=function(){return o.handleFindReplaceEvent("Replace",{type:"WString",value:a})},u=this.pageRange?this.pageRange[0]:0,d=this.pageRange?this.pageRange[1]+1:i.getPageCount(),h=u,p.label=4;case 4:return h<d?[4,s(h)]:[3,7];case 5:p.sent(),p.label=6;case 6:return h++,[3,4];case 7:return this.isReplaceAll=!1,this.setFindingDisable(!1),[4,n];case 8:return p.sent().close(),[2,l]}})}).call(this)}},{key:"setOption",value:function(e){this.findOption=e,this.dialog.findOption=this.findOption,1&this.findOption?this.$optWholeWords.attr("checked",!0):this.$optWholeWords.removeAttr("checked"),2&this.findOption?this.$optCaseSensitive.attr("checked",!0):this.$optCaseSensitive.removeAttr("checked")}},{key:"show",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.dialog||this.initDialog(),this.resetForm();var o=S(this.PDFUI.viewerFactory.wrapperElement);return this.position(o),t||(this.setFindingDisable(!0),this.$dialog.attr("loading",!0),this.PDFUI.getRootComponent().then(function(t){return e.dialog.open(t)})),this.PDFUI.eventEmitter.emit(U.findReplaceDialogVisibleChange,!0),this.setFindingDisable(!1),this.$dialog.removeAttr("loading"),this.updateProtectedViewState(),setTimeout(function(){e.$findValue.focus(),e.$findValue.val(i),e.onInput(),t&&(e.$replaceValue.val(r),e.setOption(n),e.doReplaceAll(!0,!0),setTimeout(function(){e.$replaceAll.trigger("click",[t])},500)),e.toggleReplaceButtons(a)},300),this}},{key:"position",value:function(e){var t=this;if(this.$dialog){e||(e=S(this.PDFUI.viewerFactory.wrapperElement));var n=e.offset();this.$dialog.css("top",n.top+10),this.PDFUI.getComponentByName("sidebar-right").then(function(e){var n=0;e&&e.element&&e.isExpand&&(n=S(e.element).width()),t.$dialog.css("right",n+20)})}}},{key:"resetFindPostion",value:function(){this.lastFoundPage=-1}},{key:"destroy",value:function(){[this.$replace,this.$replaceAll,this.$btnNext,this.$btnPrev,this.$optWholeWords,this.$optCaseSensitive].forEach(function(e){return e&&e.off("click")}),[this.$findValue,this.$replaceValue].forEach(function(e){return e&&e.off("input")}),[this.$findValue,this.$replaceValue].forEach(function(e){return e&&e.off("keydown")})}}]),e}(),j=i(936),B=i.n(j),N=UIExtension.vendors.jQuery,W=function(){function e(t){c(this,e),this.PDFUI=t}return d(e,[{key:"initDialog",value:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]||this.PDFUI,B()());this.dialog=this.PDFUI.parseTemplate(t),this.dialog.localize(),this.dialog.mounted(),this.$dialog=N(this.dialog.element),this.$currentPageIndex=N("[name=currentPageIndex]",this.$dialog),this.$totalPage=N("[name=totalPage]",this.$dialog),this.$cancel=N("[name=cancel]",this.$dialog),this.$progressbar=N(".find-replace-progressbar-grey",this.$dialog),this.$progresstext=N(".find-replace-progresstext",this.$dialog),this.$cancel.on("click",function(){e.$dialog.attr("canceled","true"),e.setCancelDisabled(),e.PDFUI.getCurrentPDFDoc().then(function(e){return e.getTouchup().handleFindReplaceEvent("AbortReplaceAll")})}),this.$dialog.on("wheel",function(e){return e.stopPropagation(),e.preventDefault(),!1})}},{key:"setCancelDisabled",value:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?this.$cancel.attr("disabled",!0):this.$cancel.removeAttr("disabled")}},{key:"hide",value:function(){this.dialog&&(this.$dialog.removeAttr("canceled"),this.dialog.isVisible&&this.dialog.hide())}},{key:"show",value:function(){this.dialog||this.initDialog();var e=this.PDFUI.pdfViewer.$ui.parent();return this.position(e),this.dialog.open(e[0]),this.setCancelDisabled(!1),this}},{key:"setProgress",value:function(e,t){var n=e/t*100|0;this.$currentPageIndex.html(e),this.$totalPage.html(t),this.$progressbar.css("width",n+"%"),this.$progresstext.html(n+"%")}},{key:"position",value:function(e){if(this.$dialog){e||(e=this.PDFUI.pdfViewer.$ui.parent());var t=e.offset(),n=e.width();this.$dialog.css("bottom",22).css("left",t.left+n-388)}}},{key:"destroy",value:function(){this.$dialog&&(this.$cancel.off("click"),this.$dialog.off("wheel"))}}]),e}(),H=PDFViewCtrl.ViewerEvents,L=window.UIExtension.UIEvents,M=function(e){function n(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var r;return c(this,n),(r=l(this,n,b(t))).isDashboardRecorded=!1,r}return f(n,e),d(n,[{key:"init",value:function(e){var t,n=this;this.pdfUI=e,this.destroyHooks=[],this.findReplaceDialog=e.findReplaceDialog=new T(e,this),this.progressDialog=e.findReplaceProgressDialog=new W(e,this),this.destroyHooks.push(e.addViewerEventListener((h(t={"active-find-replace":function(t,i){var r=e.customs.isAccountExpired;!!r&&r(!0)||(e.customs&&e.customs.isDisableButton&&e.customs.isDisableButton("search-replace")||(n.findReplaceDialog.$dialog&&n.findReplaceDialog.$dialog.css("opacity",""),n.findReplaceDialog.show(void 0,void 0,t,void 0,i),n.findReplaceDialog.dialog.isVisible||(n.isDashboardRecorded=!1)))},"find-replace-from-text-cmd":function(e,t,i){n.findReplaceDialog.show(!0,e,t,i)},"find-replace-goto":function(e){var t=e.pageIndex,i=e.top,r=e.left;n.findReplaceDialog.dialog&&n.findReplaceDialog.goto(t,i,r)},"find-replace-progress":function(e){var t=e.pageIndex,i=e.total;n.progressDialog.dialog&&(t<i?(0===t&&n.progressDialog.show(),n.progressDialog.setProgress(t+1,i)):setTimeout(function(){return n.progressDialog.hide()},1e3))},"find-replace-abort":function(){n.progressDialog.hide()}},H.willCloseDocument,function(){n.findReplaceDialog.hide()}),h(t,H.fitWidthResizeViewport,function(){n.findReplaceDialog.position(),n.progressDialog.position()}),h(t,L.exitReadMode,function(){setTimeout(function(){n.findReplaceDialog.position()})}),h(t,H.switchStateHandler,function(){n.findReplaceDialog.setLoaded()}),t)))}},{key:"doReplace",value:function(){this.findReplaceDialog.dialog.isVisible&&!this.isDashboardRecorded&&(this.isDashboardRecorded=!0,this.pdfUI.customs&&this.pdfUI.customs.updateTrialPermission&&this.pdfUI.customs.updateTrialPermission("search-replace"))}},{key:"onHide",value:function(){this.isDashboardRecorded=!1}},{key:"destroy",value:function(){this.findReplaceDialog.destroy(),this.progressDialog.destroy(),this.destroyHooks.forEach(function(e){return e()}),this.destroyHooks=[]}},{key:"activate",value:function(){return this.isActivated||(this.findReplaceDialog.show(),this.findReplaceDialog.$dialog.css("opacity",0),this.isActivated=!0),Promise.resolve()}},{key:"deactivate",value:function(){return this.isActivated?(this.findReplaceDialog.hide(),this.findReplaceDialog.$dialog.css("opacity",""),this.isActivated=!1,Promise.resolve()):Promise.resolve()}},{key:"validatePageRange",value:function(e){return t(function(){var t,n;return m(this,function(i){switch(i.label){case 0:return[4,this.pdfUI.getCurrentPDFDoc()];case 1:if(t=i.sent(),n=t.getPageCount(),s(!e,Array)||e.length<2||e[0]<0||e[0]>e[1]||e[0]>=n||e[1]<0||e[1]>=n)throw new Error("page range error!");return[2]}})}).call(this)}},{key:"clearCache",value:function(){return this.isActivated?this.findReplaceDialog.clearCacheHandler():Promise.reject("Please activate the find and replace function first.")}},{key:"find",value:function(e,n){return t(function(){var t;return m(this,function(i){switch(i.label){case 0:return t=this,this.isActivated?n.pageRange?[4,this.validatePageRange(n.pageRange)]:[3,2]:[2,Promise.reject("Please activate the find and replace function first.")];case 1:i.sent(),i.label=2;case 2:return[2,this.findReplaceDialog.findHandler(e,n.pageRange,this._getRealOptions(n)).then(function(e){return e.isFound&&t.pdfUI.eventEmitter.emit(H.findSuccess,e),e})]}})}).call(this)}},{key:"replace",value:function(e,n,i){return t(function(){var t;return m(this,function(r){switch(r.label){case 0:return t=this,this.isActivated?i.pageRange?[4,this.validatePageRange(i.pageRange)]:[3,2]:[2,Promise.reject("Please activate the find and replace function first.")];case 1:r.sent(),r.label=2;case 2:return[2,this.findReplaceDialog.replaceHandler(e,n,i.pageRange,this._getRealOptions(i)).then(function(e){return 1===e&&t.pdfUI.eventEmitter.emit(H.replaceSuccess),e})]}})}).call(this)}},{key:"replaceAll",value:function(e,n,i){return t(function(){var t;return m(this,function(r){switch(r.label){case 0:return t=this,this.isActivated?i.pageRange?[4,this.validatePageRange(i.pageRange)]:[3,2]:[2,Promise.reject("Please activate the find and replace function first.")];case 1:r.sent(),r.label=2;case 2:return[2,this.findReplaceDialog.replaceAllHandler(e,n,i.pageRange,this._getRealOptions(i)).then(function(e){return 0!=e&&t.pdfUI.eventEmitter.emit(H.replaceAllSuccess,e),e})]}})}).call(this)}},{key:"setNeedToReplace",value:function(e){this.needToReplace=e}},{key:"_getRealOptions",value:function(e){var t=Object.assign({},{wholeWords:!1,caseSensitive:!1,isReversed:!1},e);return t=(t.wholeWords?1:0)|(t.caseSensitive?2:0)|(t.isReversed?0:4)}}],[{key:"getName",value:function(){return"findReplace"}},{key:"getLoader",value:function(){return $()}},{key:"initOnLoad",value:function(){var e=y.modular.module("find-replace",[]);e.registerController(w),e.registerFragment(R.name,R.fragment)}}]),n}(y.UIXAddon);Object.assign(y.addons,{find_replace:{FindReplaceController:w}})})(),r=r.default})());
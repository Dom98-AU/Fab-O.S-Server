!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("UIExtension")):"function"==typeof define&&define.amd?define(["UIExtension"],t):"object"==typeof exports?exports.ReadAloudAddon=t(require("UIExtension")):e.ReadAloudAddon=t(e.UIExtension)}(self,e=>(()=>{var t={490:e=>{e.exports=null},616:t=>{"use strict";t.exports=e}},n={};function o(e){var a=n[e];if(void 0!==a)return a.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,o),r.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var a={};return(()=>{"use strict";function e(t){return e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e(t)}function t(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(t=function(){return!!e})()}function n(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}function r(o,a,r){return a=e(a),n(o,t()?Reflect.construct(a,r||[],e(o).constructor):a.apply(o,r))}function i(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):i(e,t)}function u(e,t){if(!i(e,t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}o.d(a,{default:()=>de});var p=o(616),v=o(490),f=o.n(v);function h(t,n,o){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,n,o){var a=function(t,n){for(;!Object.prototype.hasOwnProperty.call(t,n)&&null!==(t=e(t)););return t}(t,n);if(a){var r=Object.getOwnPropertyDescriptor(a,n);return r.get?r.get.call(o||t):r.value}},h(t,n,o||t)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=p.PDFViewCtrl,b=y.PDF.constant.User_Permissions,g=y.readAloud.Store,k=y.commons.ValueStore,w="view_tab",x=function(e){return e.page="page",e.doc="doc",e.fragment="fragment",e.none="none",e}({}),S=function(e){return e.activated="activated",e.deactivated="deactivated",e}({}),C=p.PDFViewCtrl.ViewerEvents,_=function(e){function t(){var e;return u(this,t),m(e=r(this,t,arguments),"service",void 0),m(e,"currentReadType",new g),m(e,"activationStatus",new g),m(e,"pdfUI",void 0),m(e,"voicesStore",new k([])),e}return d(t,e),l(t,[{key:"allInjected",value:function(){var e=this;this.currentReadType.set("none"),this.addDestroyHook(this.service.onReadPageStart(function(t){e.pdfUI.goToPage(t,0,0,!1)})),this.addDestroyHook(this.pdfUI.addViewerEventListener(C.willCloseDocument,function(){e.deactivate()})),this.pdfUI.getStore().then(function(t){e.addDestroyHook(t.subscribe(p.PDFViewCtrl.Consts.STORE_NAMES.SELECTION_INFO,function(t){if(e.service)if(t){var n=t.isReadSelectText;(void 0===n||n)&&e.isActivated()&&(e.isStopped()||"fragment"===e.currentReadType.get())&&(e.currentReadType.set("fragment"),e.service.readText({text:t.text,pageIndex:t.page.getIndex(),rect:t.rectArray}))}else"fragment"===e.currentReadType.get()&&e.stop()}))}),this.service.active?this.activate():this.deactivate()}},{key:"supported",value:function(){return Promise.resolve(this.service.supported())}},{key:"preCheckDoc",value:function(e){var t="";return e?e.doc.checkPermission(b.extractAccess)||(t="read-aloud:error.permDenyCopyContent"):t="read-aloud:error.document-not-openned",t&&(this.currentReadType.set("none"),this.pdfUI.alert(t)),!t}},{key:"isAccountExpired",value:function(){return!1}},{key:"readCurrentPage",value:function(){var e=this;if(!this.isAccountExpired())return"paused"===this.status?this.resume():(this.service.beforeRead(),this.pdfUI.getPDFDocRender().then(function(t){if(e.preCheckDoc(t)){e.sendGAEvent({eventKey:"dropdown-read-current-page",label:w}),e.currentReadType.set("page");var n=t.getCurrentPageIndex();return e.service.readPages([n])}}).finally(function(){e.service.afterRead()}))}},{key:"readFromCurrentPage",value:function(){var e=this;return"paused"===this.status?this.resume():(this.service.beforeRead(),this.pdfUI.getPDFDocRender().then(function(t){if(e.preCheckDoc(t)){e.sendGAEvent({eventKey:"dropdown-read-from-current-page",label:w}),e.currentReadType.set("doc");var n=t.getCurrentPageIndex(),o=t.getPDFDoc().getPageCount(),a=Array(o-n).fill(0).map(function(e,t){return n+t});return e.service.readPages(a)}}).finally(function(){e.service.afterRead()}))}},{key:"stop",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.pdfUI.getReadAloudService().then(function(n){return t&&e.sendGAEvent({eventKey:"dropdown-stop-read",label:w}),e.currentReadType.set("none"),n.stop()})}},{key:"pause",value:function(){var e=this;return this.pdfUI.getReadAloudService().then(function(t){return e.sendGAEvent({eventKey:"dropdown-pause-read",label:w}),t.pause()})}},{key:"resume",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.pdfUI.getReadAloudService().then(function(n){return t&&e.sendGAEvent({eventKey:"dropdown-pause-read",label:w}),n.resume()})}},{key:"setVolume",value:function(e){var t=this;return this.pdfUI.getReadAloudService().then(function(n){return t.sendGAEvent({eventKey:"dropdown-adjusted-read-volume",label:w}),n.setVolume(e)})}},{key:"setRate",value:function(e){var t=this;return this.pdfUI.getReadAloudService().then(function(n){return t.sendGAEvent({eventKey:"dropdown-adjusted-read-rate",label:w}),n.setRate(e)})}},{key:"setVoices",value:function(e){this.voicesStore.dispatch(e)}},{key:"getVoices",value:function(){return this.voicesStore.getCurrentValue()}},{key:"onVoicesChange",value:function(e){return this.voicesStore.subscribe(e)}},{key:"loadVoices",value:function(){var e=this;return this.service.getVoices().then(function(t){e.voicesStore.dispatch(t)})}},{key:"status",get:function(){return this.service?this.service.status:"stopped"}},{key:"getCurrentReadType",value:function(){return this.currentReadType.get()}},{key:"isStopped",value:function(){return!this.service||"stopped"===this.service.status}},{key:"activate",value:function(){this.sendGAEvent({eventKey:"dropdown-activate-read",label:w}),this.activationStatus.set("activated"),this.service.active=!0}},{key:"deactivate",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.stop().then(function(){t&&e.sendGAEvent({eventKey:"dropdown-deactivate-read",label:w}),e.activationStatus.set("deactivated"),e.service.active=!1})}},{key:"isActivated",value:function(){return"activated"===this.activationStatus.get()}},{key:"onActivationChange",value:function(e){return this.activationStatus.onchange(e)}},{key:"onStatusChange",value:function(e){var t=this.pdfUI.getReadAloudService().then(function(t){return t.onStatusChange(e)});return function(){t.then(function(e){return e()})}}},{key:"onReadTypeChange",value:function(e){return this.currentReadType.onchange(e)}},{key:"sendGAEvent",value:function(){}}],[{key:"scope",value:function(){return p.ServiceScope.SINGLETON}},{key:"inject",value:function(){return{pdfUI:p.PDFUI,service:p.PDFViewCtrl.readAloud.ReadAloudService}}}]),t}(p.PDFViewCtrl.shared.Disposable),T=function(t){function n(){return u(this,n),r(this,n,arguments)}return d(n,t),l(n,[{key:"postlink",value:function(){h(e(n.prototype),"postlink",this).call(this),this.getComponentByName("fv--read-aloud-rate-slider-container").append('\n            <slider \n                min="'.concat(this.min,'"\n                max="').concat(this.max,'"\n                value="').concat(this.value,'"\n                step="').concat(this.step,'"\n                @on.change="self.change($component.getValue())"\n                class="fv__ui-slider-no-input"\n                name="dropdown-adjusted-read-rate"\n                label="read-aloud:read-aloud.rate.text"\n            ></slider>\n        '))}},{key:"change",value:function(e){return this.service.setRate(e)}}],[{key:"getName",value:function(){return"rate-regulator-ribbon"}},{key:"services",value:function(){return{service:_}}},{key:"getMetadata",value:function(){return{options:{min:{type:"number",defaultValue:.1},max:{type:"number",defaultValue:2},step:{type:"number",defaultValue:.1},value:{type:"number",defaultValue:1}}}}}]),n}(p.SeniorComponentFactory.createSuperClass({template:'\n    <ribbon-button @tooltip tooltip-title="read-aloud:read-aloud.rate.desc"\n     text="read-aloud:read-aloud.rate.text"\n     icon-class="fx-icon-ribbon_view_read_rate-32"\n     @read-aloud:support.disable\n     @read-aloud:activation.unlock\n     class="rate-regulator"\n     @var.self="$component">\n        <dropdown\n            separate="false"\n            valign="top"\n            selectable="false"\n            class="fv__ui-read-aloud-rate-regulator rate-dropdown fv__ui-dropdown-hide-text"\n        >\n            <dropdown-item @stop-propagation.mouseup name="fv--read-aloud-rate-slider-container">\n                \n            </dropdown-item>\n        </dropdown>\n    </ribbon-button>\n    '})),A=function(t){function n(){return u(this,n),r(this,n,arguments)}return d(n,t),l(n,[{key:"postlink",value:function(){var t=this;h(e(n.prototype),"postlink",this).call(this),this.getComponentByName("fv--read-aloud-rate-slider-container").append('\n            <slider \n                min="'.concat(this.min,'"\n                max="').concat(this.max,'"\n                value="').concat(this.value,'"\n                step="').concat(this.step,'"\n                @on.change="self.change($component.getValue())"\n                class="fv__ui-slider-no-input"\n                name="dropdown-adjusted-read-rate"\n                label="read-aloud:read-aloud.rate.text"\n                role="menuitem"\n            ></slider>\n        '));var o=this.getPDFUI();o||(o=window.pdfui),this.addDestroyHook(o.addViewerEventListener(p.UIEvents.changeReadSpeed,function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?(t.value=t.value+.1,t.value>t.max&&(t.value=t.max)):(t.value=t.value-.1,t.value<t.min&&(t.value=t.min)),t.value=parseFloat(t.value.toFixed(1)),t.change(t.value),o.getComponentByName("dropdown-adjusted-read-rate").then(function(e){e&&e.setValue(t.value)})}))}},{key:"change",value:function(e){return this.service.setRate(e)}}],[{key:"getName",value:function(){return"rate-regulator"}},{key:"services",value:function(){return{service:_}}},{key:"getMetadata",value:function(){return{options:{min:{type:"number",defaultValue:.1},max:{type:"number",defaultValue:2},step:{type:"number",defaultValue:.1},value:{type:"number",defaultValue:1}}}}}]),n}(p.SeniorComponentFactory.createSuperClass({template:'\n    <dropdown\n        icon-class="fx-icon-ribbon_view_read_rate-16"\n        @tooltip tooltip-title="read-aloud:read-aloud.rate.desc"\n        tooltip-description="read-aloud:read-aloud.rate.descSub"\n        @read-aloud:activation.unlock\n        separate="false"\n        align="out-right"\n        valign="top"\n        class="fv__ui-read-aloud-rate-regulator rate-dropdown"\n        @read-aloud:support.disable\n        text="read-aloud:read-aloud.rate.text"\n        @var.self="$component"\n        text="read-aloud:read-aloud.rate.text"\n        selectable="false"\n    >\n        <dropdown-item @stop-propagation.mouseup name="fv--read-aloud-rate-slider-container">\n            \n        </dropdown-item>\n    </dropdown>\n    '})),V=p.PDFViewCtrl.readAloud.PDFTextToSpeechSynthesisStatus,D=JSON.stringify({shortcutKey:"Shift+Ctrl+V",handleName:"click"}),I=function(t){function n(){return u(this,n),r(this,n,arguments)}return d(n,t),l(n,[{key:"lock",value:function(){h(e(n.prototype),"lock",this).call(this),this.element.removeAttribute("tabindex")}},{key:"unlock",value:function(){h(e(n.prototype),"unlock",this).call(this),this.element.setAttribute("tabindex","0")}},{key:"mounted",value:function(){var t=this;h(e(n.prototype),"mounted",this).call(this),this.addDestroyHook(this.service.onStatusChange(function(e){e===V.stopped?t.deactive():t.service.getCurrentReadType()===x.page?t.active():t.deactive()}))}},{key:"click",value:function(){var e=this;return this.service.readCurrentPage().catch(function(t){if(e.service.stop(),t&&"interrupted"===t.error)return e.getPDFUI().alert({message:"read-aloud:error.interrupted",level:"warning"});throw t})}}],[{key:"getName",value:function(){return"read-current-page"}},{key:"services",value:function(){return{service:_}}}]),n}(p.SeniorComponentFactory.createSuperClass({template:'\n        <xbutton\n            @on.click="$component.click()" \n            icon-class="fx-icon-sm fx-icon-ribbon_view_read_current_page-16" \n            @tooltip tooltip-title="read-aloud:read-aloud.read-current-page.desc"\n            tooltip-description="read-aloud:read-aloud.read-current-page.descSub"\n            @read-aloud:activation.unlock\n            @read-aloud:shortcutKey='.concat(D,'\n            text="read-aloud:read-aloud.read-current-page.text"\n            tabindex="0"\n        ></xbutton>\n    ')})),P=p.PDFViewCtrl.readAloud.PDFTextToSpeechSynthesisStatus,F=JSON.stringify({shortcutKey:"Shift+Ctrl+B",handleName:"click"}),R=function(t){function n(){return u(this,n),r(this,n,arguments)}return d(n,t),l(n,[{key:"lock",value:function(){h(e(n.prototype),"lock",this).call(this),this.element.removeAttribute("tabindex")}},{key:"unlock",value:function(){h(e(n.prototype),"unlock",this).call(this),this.element.setAttribute("tabindex","0")}},{key:"mounted",value:function(){var t=this;h(e(n.prototype),"mounted",this).call(this),this.addDestroyHook(this.service.onStatusChange(function(e){e===P.stopped?t.deactive():t.service.getCurrentReadType()===x.doc?t.active():t.deactive()}))}},{key:"click",value:function(){var e=this;return this.service.readFromCurrentPage().catch(function(t){if(e.service.stop(),t&&"interrupted"===t.error)return e.getPDFUI().alert({message:"read-aloud:error.interrupted",level:"warning"});throw t})}}],[{key:"getName",value:function(){return"read-from-current-page"}},{key:"services",value:function(){return{service:_}}}]),n}(p.SeniorComponentFactory.createSuperClass({template:'\n        <xbutton\n            @on.click="$component.click()" \n            icon-class="fx-icon-sm fx-icon-ribbon_view_read_from_current_page-16"\n            @tooltip tooltip-title="read-aloud:read-aloud.read-from-current-page.desc"\n            tooltip-description="read-aloud:read-aloud.read-from-current-page.descSub"\n            @read-aloud:activation.unlock\n            @read-aloud:shortcutKey='.concat(F,'\n            text="read-aloud:read-aloud.read-from-current-page.text"\n            tabindex="0"\n        ></xbutton>\n    ')})),N=function(t){function n(){return u(this,n),r(this,n,arguments)}return d(n,t),l(n,[{key:"postlink",value:function(){h(e(n.prototype),"postlink",this).call(this),this.getComponentByName("fv--read-aloud-volume-slider-container").append('\n            <slider \n                min="'.concat(this.min,'"\n                max="').concat(this.max,'"\n                value="').concat(this.value,'"\n                step="').concat(this.step,'"\n                @on.change="self.change($component.getValue())"\n                class="fv__ui-slider-no-input"\n                name="dropdown-adjusted-read-volume"\n                label=\'read-aloud:read-aloud.volume.text\'\n                role="menuitem"\n            ></slider>\n        '))}},{key:"change",value:function(e){return this.service.setVolume(e)}}],[{key:"getName",value:function(){return"volume-regulator-ribbon"}},{key:"services",value:function(){return{service:_}}},{key:"getMetadata",value:function(){return{options:{min:{type:"number",defaultValue:0},max:{type:"number",defaultValue:1},step:{type:"number",defaultValue:.1},value:{type:"number",defaultValue:1}}}}}]),n}(p.SeniorComponentFactory.createSuperClass({template:'\n    <ribbon-button @tooltip tooltip-title="read-aloud:read-aloud.volume.desc"\n     tooltip-description="read-aloud:read-aloud.volume.descSub"\n     icon-class="fx-icon-ribbon_view_read_volume-32"\n     text="read-aloud:read-aloud.volume.text"\n     icon-class="fx-icon-ribbon_view_read-32"\n     class="volume-regulator"\n     @read-aloud:support.disable\n     @read-aloud:activation.unlock\n     @var.self="$component">\n        <dropdown\n            separate="false"\n            valign="top"\n            selectable="false"\n            class="fv__ui-read-aloud-volume-regulator volume-dropdown fv__ui-dropdown-hide-text"\n        >\n            <dropdown-item @stop-propagation.mouseup name="fv--read-aloud-volume-slider-container">\n            </dropdown-item>\n        </dropdown>\n    </ribbon-button>\n    '})),E=function(t){function n(){return u(this,n),r(this,n,arguments)}return d(n,t),l(n,[{key:"postlink",value:function(){var t=this;h(e(n.prototype),"postlink",this).call(this),this.getComponentByName("fv--read-aloud-volume-slider-container").append('\n            <slider \n                min="'.concat(this.min,'"\n                max="').concat(this.max,'"\n                value="').concat(this.value,'"\n                step="').concat(this.step,'"\n                @on.change="self.change($component.getValue())"\n                class="fv__ui-slider-no-input"\n                name="dropdown-adjusted-read-volume"\n                label=\'read-aloud:read-aloud.volume.text\'\n                role="menuitem"\n            ></slider>\n        '));var o=this.getPDFUI();o||(o=window.pdfui),this.addDestroyHook(o.addViewerEventListener(p.UIEvents.changeReadVolume,function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?(t.value=t.value+.1,t.value>t.max&&(t.value=t.max)):(t.value=t.value-.1,t.value<t.min&&(t.value=t.min)),t.value=parseFloat(t.value.toFixed(1)),t.change(t.value),o.getComponentByName("dropdown-adjusted-read-volume").then(function(e){e&&e.setValue(t.value)})}))}},{key:"change",value:function(e){return this.service.setVolume(e)}}],[{key:"getName",value:function(){return"volume-regulator"}},{key:"services",value:function(){return{service:_}}},{key:"getMetadata",value:function(){return{options:{min:{type:"number",defaultValue:0},max:{type:"number",defaultValue:1},step:{type:"number",defaultValue:.1},value:{type:"number",defaultValue:1}}}}}]),n}(p.SeniorComponentFactory.createSuperClass({template:'\n    <dropdown\n        icon-class="fx-icon-ribbon_view_read_volume-16"\n        @tooltip tooltip-title="read-aloud:read-aloud.volume.desc"\n        tooltip-description="read-aloud:read-aloud.volume.descSub"\n        @read-aloud:activation.unlock\n        separate="false"\n        align="out-right"\n        valign="top"\n        class="fv__ui-read-aloud-volume-regulator volume-dropdown"\n        @read-aloud:support.disable\n        text="read-aloud:read-aloud.volume.text"\n        @var.self="$component"\n        text="read-aloud:read-aloud.volume.text"\n        selectable="false"\n    >\n        <dropdown-item @stop-propagation.mouseup name="fv--read-aloud-volume-slider-container">\n        </dropdown-item>\n    </dropdown>\n    '}));function U(e,t,n,o,a,r,i){try{var u=e[r](i),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(o,a)}function O(e){return function(){var t=this,n=arguments;return new Promise(function(o,a){var r=e.apply(t,n);function i(e){U(r,o,a,i,u,"next",e)}function u(e){U(r,o,a,i,u,"throw",e)}i(void 0)})}}function j(e,t){var n,o,a,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=u(0),i.throw=u(1),i.return=u(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(r=0)),r;)try{if(n=1,o&&(a=2&u[0]?o.return:u[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,u[1])).done)return a;switch(o=0,a&&(u=[2&u[0],a.value]),u[0]){case 0:case 1:a=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(!(a=r.trys,(a=a.length>0&&a[a.length-1])||6!==u[0]&&2!==u[0])){r=0;continue}if(3===u[0]&&(!a||u[1]>a[0]&&u[1]<a[3])){r.label=u[1];break}if(6===u[0]&&r.label<a[1]){r.label=a[1],a=u;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(u);break}a[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(e){u=[6,e],o=0}finally{n=a=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError;p.PDFUI,p.UIXAddon,p.SeniorComponentFactory,p.modular,p.ServiceScope,p.Directive,p.Controller,p.Component,p.ContainerComponent,p.UIEvents,p.UIConsts;var K=p.shared,B=(K.keyboardStatus,K.attachContextMenuEvent,p.PDFViewCtrl),$=B.PDFViewer,L=B.ViewerEvents,H=(B.DeviceInfo,B.BrowserInfo,B.storage.StorageFeature,B.shared),G=(H.Disposable,H.Store,H.ValueStore,H.debounce,H.observeResize,H.throttle,H.Draggable,H.browser,H.DebounceAsyncTaskExecutor,H.ThrottleAsyncTaskExecutor,H.QueuedAsyncTaskExecutor,H.BuiltinIntersectionObserver,H.FileFormat,H.Color,H.download,H.securityEncryptType,H.securityUtils,B.Log.LoggerFactory,B.collab.COLLABORATION_ACTION,B.vendors.Hammer,B.PDF.DataEvents,B.Consts.PDFDocPermission,B.keyboard),M=(G.BuiltinShortcutCommand,G.BuiltinShortcutContext,G.KeyboardUtils,B.keyboard.KeyboardUtils),z=M.matchers,J=(M.isMatch,z.Enter,z.Escape,B._internal.shared),X=(J.IoCScope,J.Lazy,J.attachKeypressEvent,function(t){function n(){return u(this,n),r(this,n,arguments)}return d(n,t),l(n,[{key:"mounted",value:function(){var t=this;h(e(n.prototype),"mounted",this).call(this);var o=this.getPDFUI(),a=function(){return O(function(){var e;return j(this,function(t){switch(t.label){case 0:return[4,o.getCurrentPDFDoc()];case 1:return(e=t.sent())?(e.isDynamicXFA()?this.disable():this.enable(),[2]):[2]}})}).call(t)};this.addDestroyHook(o.addViewerEventListener(L.openFileSuccess,function(){a()})),a()}}],[{key:"getName",value:function(){return"read-aloud-ribbon-dropdown"}},{key:"inject",value:function(){return{viewer:$}}}]),n}(p.SeniorComponentFactory.createSuperClass({template:'\n    <ribbon-button @tooltip tooltip-title="read-aloud:read-aloud.read.desc"\n     text="read-aloud:read-aloud.read.text"\n     icon-class="fx-icon-ribbon_view_read-32"\n     class="read-aloud"\n     not-immediately="true"\n     @var.self="$component"\n     @read-aloud:support.disable\n     >\n    <dropdown icon-class="fv__icon-read-aloud-read" \n        separate=false\n        text="read-aloud:read-aloud.read.text"\n    >\n        <dropdown-item class="fv__ui-dropdown-container-item">\n           <read-aloud:read-dropdown name="read-dropdown" ></read-aloud:read-dropdown>\n       </dropdown-item>\n       <dropdown-item class="fv__ui-dropdown-container-item">\n           <read-aloud:rate-regulator name="rate-dropdown"></read-aloud:rate-regulator>\n       </dropdown-item>\n       <dropdown-item class="fv__ui-dropdown-container-item">\n           <read-aloud:volume-regulator name="volume-dropdown"></read-aloud:volume-regulator>\n       </dropdown-item>\n       <read-aloud:pause-resume-read-aloud name ="dropdown-pause-read"></read-aloud:pause-resume-read-aloud>\n       <dropdown-item class="fv__ui-dropdown-container-item">\n            <read-aloud:select-voice-dropdown></read-aloud:select-voice-dropdown>\n       </dropdown-item>\n    </dropdown>\n</ribbon-button>\n    '}))),q=function(t){function n(){return u(this,n),r(this,n,arguments)}return d(n,t),l(n,[{key:"mounted",value:function(){var t=this;h(e(n.prototype),"mounted",this).call(this);var o=this.getPDFUI(),a=function(){return O(function(){var e;return j(this,function(t){switch(t.label){case 0:return[4,o.getCurrentPDFDoc()];case 1:return(e=t.sent())?(e.isDynamicXFA()?this.disable():this.enable(),[2]):[2]}})}).call(t)};this.addDestroyHook(o.addViewerEventListener(L.openFileSuccess,function(){a()})),a()}}],[{key:"getName",value:function(){return"read-aloud-dropdown"}},{key:"inject",value:function(){return{viewer:$}}}]),n}(p.SeniorComponentFactory.createSuperClass({template:'\n    <dropdown\n        icon-class="fv__icon-read-aloud-read"\n        @tooltip tooltip-title="read-aloud:read-aloud.read.desc"\n        separate="false"\n        @read-aloud:support.disable\n        class="fv__ui-dropdown-hide-text"\n        text="read-aloud:read-aloud.read.text"\n    >\n        <read-aloud:activate-button></read-aloud:activate-button>\n        <read-aloud:read-current-page></read-aloud:read-current-page>\n        <read-aloud:read-from-current-page></read-aloud:read-from-current-page>\n        <read-aloud:stop-read></read-aloud:stop-read>\n    </dropdown>\n    '})),Q=function(){function e(){return u(this,e),r(this,e,arguments)}return d(e,UIExtension.SeniorComponentFactory.createSuperClass({template:'\n    <dropdown \n    separate="false"\n    align="out-right"\n    valign="center"\n    class="read-dropdown"\n    icon-class="fx-icon-ribbon_view_read-16"\n    name="read-aloud-comment" \n    text="read-aloud:read-aloud.read.text"> \n    <read-aloud:activate-button ribbon-icon="fx-icon-ribbon_view_read-32"></read-aloud:activate-button>\n    <read-aloud:read-current-page ribbon-icon="fx-icon-ribbon_view_activate_read-32" name="dropdown-read-current-page"></read-aloud:read-current-page>\n    <read-aloud:read-from-current-page ribbon-icon="fx-icon-ribbon_view_read_current_page-32" name="dropdown-read-from-current-page"></read-aloud:read-from-current-page>\n    <read-aloud:stop-read ribbon-icon="fx-icon-ribbon_view_read_stop-32" name="dropdown-stop-read"></read-aloud:stop-read>\n   </dropdown>\n    '})),l(e,null,[{key:"getName",value:function(){return"read-dropdown"}}]),e}(),Y=p.PDFViewCtrl.readAloud.PDFTextToSpeechSynthesisStatus,W=JSON.stringify({shortcutKey:"Shift+Ctrl+E",handleName:"click"}),Z=function(t){function n(){return u(this,n),r(this,n,arguments)}return d(n,t),l(n,[{key:"lock",value:function(){h(e(n.prototype),"lock",this).call(this),this.element.removeAttribute("tabindex")}},{key:"unlock",value:function(){h(e(n.prototype),"unlock",this).call(this),this.element.setAttribute("tabindex","0")}},{key:"mounted",value:function(){var t=this;h(e(n.prototype),"mounted",this).call(this),this.addDestroyHook(this.service.onStatusChange(function(e){e===Y.playing?t.unlock():t.lock()}))}},{key:"click",value:function(){return this.service.stop(!0)}}],[{key:"getName",value:function(){return"stop-read"}},{key:"services",value:function(){return{service:_}}}]),n}(p.SeniorComponentFactory.createSuperClass({template:'\n        <xbutton \n            @on.click="$component.click()"\n            icon-class="fx-icon-sm fx-icon-ribbon_view_read_stop-16"\n            @tooltip tooltip-title="read-aloud:read-aloud.stop.desc"\n            tooltip-description="read-aloud:read-aloud.stop.descSub"\n            text="read-aloud:read-aloud.stop.text"\n            @read-aloud:shortcutKey='.concat(W,'\n            tabindex="0"\n        ></xbutton>\n    ')})),ee=p.PDFViewCtrl.readAloud.PDFTextToSpeechSynthesisStatus,te=JSON.stringify({shortcutKey:"Shift+Ctrl+C",handleName:"click"}),ne=function(t){function n(){return u(this,n),r(this,n,arguments)}return d(n,t),l(n,[{key:"mounted",value:function(){var t=this;h(e(n.prototype),"mounted",this).call(this);var o=function(e){switch(t.status=e,e){case ee.paused:t.switchToResumeButton();break;case ee.playing:t.switchToPauseButton();break;default:t.switchStoppedButton()}};this.service.onStatusChange(o),this.service.onActivationChange(function(){t.service.isActivated()&&o(t.service.status)}),this.setIconCls(this.pauseIconClass),this.setText(this.pauseTitle),o(this.service.status)}},{key:"switchToPauseButton",value:function(){this.unlock(),this.setIconCls(this.pauseIconClass),this.setAttribute("tooltip-title",this.pauseTooltipTitle),this.setAttribute("tooltip-description",this.pauseTooltipTitleSub),this.setAttribute("text",this.pauseTitle),this.setText(this.pauseTitle),this.localize()}},{key:"switchToResumeButton",value:function(){this.unlock(),this.setIconCls(this.resumeIconClass),this.setAttribute("tooltip-title",this.resumeTooltipTitle),this.setAttribute("tooltip-description",this.resumeTooltipTitleSub),this.setAttribute("text",this.resumeTitle),this.setText(this.resumeTitle),this.localize()}},{key:"switchStoppedButton",value:function(){this.lock(),this.text||this.setText(this.pauseTitle),this.localize()}},{key:"click",value:function(){switch(this.status){case ee.paused:this.service.resume(!0);break;case ee.playing:this.service.pause();break;default:return Promise.resolve()}}}],[{key:"getName",value:function(){return"pause-resume-read-aloud"}},{key:"services",value:function(){return{service:_}}},{key:"getMetadata",value:function(){return{options:{"pause-title":{type:"string",field:"pauseTitle",defaultValue:"read-aloud:read-aloud.pause.text"},"resume-title":{type:"string",field:"resumeTitle",defaultValue:"read-aloud:read-aloud.resume.text"},"pause-tooltip-title":{type:"string",field:"pauseTooltipTitle",defaultValue:"read-aloud:read-aloud.pause.desc"},"pause-tooltip-title-sub":{type:"string",field:"pauseTooltipTitleSub",defaultValue:"read-aloud:read-aloud.pause.descSub"},"resume-tooltip-title":{type:"string",field:"resumeTooltipTitle",defaultValue:"read-aloud:read-aloud.resume.desc"},"resume-tooltip-title-sub":{type:"string",field:"resumeTooltipTitleSub",defaultValue:"read-aloud:read-aloud.resume.descSub"},"pause-icon-class":{type:"string",field:"pauseIconClass",defaultValue:"fx-icon-ribbon_view_read_pause-16"},"resume-icon-class":{type:"string",field:"resumeIconClass",defaultValue:"fx-icon-ribbon_view_read_resume-16"}}}}}]),n}(p.SeniorComponentFactory.createSuperClass({template:'\n    <dropdown-button\n        @tooltip tooltip-title="read-aloud:read-aloud.pause.desc"\n        tooltip-description="read-aloud:read-aloud.pause.descSub"\n        @on.click="$component.click()"\n        @read-aloud:activation.unlock\n        @read-aloud:support.disable\n        @read-aloud:shortcutKey.pauseresume='.concat(te,'\n        icon-class="fx-icon-ribbon_view_read_pause-16"\n        text="read-aloud:read-aloud.pause.text"\n        class="pause-resume-button"\n    >\n    </dropdown-button>\n    ')})),oe=function(t){function n(){return u(this,n),r(this,n,arguments)}return d(n,t),l(n,[{key:"mounted",value:function(){var t=this;h(e(n.prototype),"mounted",this).call(this);var o=function(e){switch(t.status=e,e){case ee.paused:t.switchToResumeButton();break;case ee.playing:t.switchToPauseButton();break;default:t.switchStoppedButton()}};this.service.onStatusChange(o),this.service.onActivationChange(function(){t.service.isActivated()&&o(t.service.status)}),this.setIconCls(this.pauseIconClass),this.setText(this.pauseTitle),o(this.service.status)}},{key:"switchToPauseButton",value:function(){this.unlock(),this.setIconCls(this.pauseIconClass),this.setAttribute("tooltip-title",this.pauseTooltipTitle),this.setAttribute("tooltip-description",this.pauseTooltipTitleSub),this.setAttribute("text",this.pauseTitle),this.setText(this.pauseTitle),this.localize()}},{key:"switchToResumeButton",value:function(){this.unlock(),this.setIconCls(this.resumeIconClass),this.setAttribute("tooltip-title",this.resumeTooltipTitle),this.setAttribute("tooltip-description",this.resumeTooltipTitleSub),this.setAttribute("text",this.resumeTitle),this.setText(this.resumeTitle),this.localize()}},{key:"switchStoppedButton",value:function(){this.lock(),this.text||this.setText(this.pauseTitle),this.localize()}},{key:"click",value:function(){switch(this.status){case ee.paused:this.service.resume();break;case ee.playing:this.service.pause();break;default:return Promise.resolve()}}}],[{key:"getName",value:function(){return"pause-resume-read-aloud-ribbon"}},{key:"services",value:function(){return{service:_}}},{key:"getMetadata",value:function(){return{options:{"pause-title":{type:"string",field:"pauseTitle",defaultValue:"read-aloud:read-aloud.pause.text"},"resume-title":{type:"string",field:"resumeTitle",defaultValue:"read-aloud:read-aloud.resume.text"},"pause-tooltip-title":{type:"string",field:"pauseTooltipTitle",defaultValue:"read-aloud:read-aloud.pause.desc"},"pause-tooltip-title-sub":{type:"string",field:"pauseTooltipTitleSub",defaultValue:"read-aloud:read-aloud.pause.descSub"},"resume-tooltip-title":{type:"string",field:"resumeTooltipTitle",defaultValue:"read-aloud:read-aloud.resume.desc"},"resume-tooltip-title-sub":{type:"string",field:"resumeTooltipTitleSub",defaultValue:"read-aloud:read-aloud.resume.descSub"},"pause-icon-class":{type:"string",field:"pauseIconClass",defaultValue:"fx-icon-ribbon_view_read_pause-32"},"resume-icon-class":{type:"string",field:"resumeIconClass",defaultValue:"fx-icon-ribbon_view_read_resume-32"}}}}}]),n}(p.SeniorComponentFactory.createSuperClass({template:'\n    <ribbon-button @tooltip tooltip-title="read-aloud:read-aloud.pause.desc"\n     tooltip-description="read-aloud:read-aloud.pause.descSub"\n     text="read-aloud:read-aloud.pause.text"\n     icon-class="fx-icon-ribbon_view_read_pause-32"\n     @read-aloud:activation.unlock\n     @read-aloud:support.disable\n     @read-aloud:shortcutKey.pauseresume='.concat(te,'\n     @on.click="$component.click()"\n     class="pause-resume pause-resume-button">\n    </ribbon-button>\n    ')})),ae=(p.PDFViewCtrl.readAloud,function(t){function n(){return u(this,n),r(this,n,arguments)}return d(n,t),l(n,[{key:"init",value:function(t){var o=this;h(e(n.prototype),"init",this).call(this,t),this.addDestroyHook(this.service.onActivationChange(function(e){var n=e===S.activated;switch(o.subName){case"disable":n?t.disable():t.enable();break;case"lock":n?t.lock():t.unlock();break;case"enable":n?t.enable():t.disable();break;case"unlock":n?t.unlock():t.lock();break;case"show":n?t.show():t.hide()}}))}}],[{key:"getName",value:function(){return"activation"}},{key:"services",value:function(){return{service:_}}}]),n}(p.Directive)),re={},ie=function(t){function n(){return u(this,n),r(this,n,arguments)}return d(n,t),l(n,[{key:"init",value:function(t){var o=this;h(e(n.prototype),"init",this).call(this,t);var a=this.getShortcutKeyOptions(),r=a.shortcutKey,i=a.handleName;if(t[i]&&!re[t.nodeName]){var u=t.pdfUI.pdfViewer,s=function(e){if(u.getCurrentPDFDoc()&&t.isVisible&&!t.disabled)return t[i].bind(t)(),"pauseresume"===o.subName?(e.nativeEvent.preventDefault(),!1):void 0};u.onShortcutKey(r,s),re[t.nodeName]=!0,this.addDestroyHook(function(){u.offShortcutKey(r,s)})}}},{key:"getShortcutKeyOptions",value:function(){var e,t;try{var n=JSON.parse(this.attrValue),o=n.shortcutKey,a=n.handleName;e=o,t=a}catch(e){}return{shortcutKey:e,handleName:t}}}],[{key:"getName",value:function(){return"shortcutKey"}}]),n}(p.Directive),ue=JSON.stringify({shortcutKey:"Shift+Ctrl+Y",handleName:"click"}),se=function(t){function n(){return u(this,n),r(this,n,arguments)}return d(n,t),l(n,[{key:"switchToDeactivateButton",value:function(){this.active(),this.setText("read-aloud:read-aloud.deactivate-read.text"),this.setAttribute("tooltip-title","read-aloud:read-aloud.deactivate-read.desc"),this.setAttribute("tooltip-description","read-aloud:read-aloud.deactivate-read.descSub"),this.setNameAttribute("dropdown-deactivate-read")}},{key:"switchToActivateButton",value:function(){this.deactive(),this.setText("read-aloud:read-aloud.activate-read.text"),this.setAttribute("tooltip-title","read-aloud:read-aloud.activate-read.desc"),this.setAttribute("tooltip-description","read-aloud:read-aloud.activate-read.descSub"),this.setNameAttribute("dropdown-activate-read")}},{key:"setNameAttribute",value:function(e){this.setAttribute("name",e),this.setAttribute("component-name",e),this.name=e}},{key:"mounted",value:function(){var t=this;h(e(n.prototype),"mounted",this).call(this),this.addDestroyHook(this.service.onActivationChange(function(){t.service.isActivated()?t.switchToDeactivateButton():t.switchToActivateButton()}))}},{key:"click",value:function(){if(this.pdfUI.checkAppSignIn())return this.service.isActivated()?this.service.deactivate(!0):this.service.activate()}}],[{key:"getName",value:function(){return"activate-button"}},{key:"services",value:function(){return{service:_}}}]),n}(p.SeniorComponentFactory.createSuperClass({template:'<xbutton\n        @on.click="$component.click()"\n        @read-aloud:shortcutKey='.concat(ue,'\n        @tooltip\n        icon-class="fx-icon-sm fx-icon-ribbon_view_activate_read-16"\n        tabindex="0"\n    >\n    </xbutton>')})),le=function(t){function n(){return u(this,n),r(this,n,arguments)}return d(n,t),l(n,[{key:"init",value:function(t){h(e(n.prototype),"init",this).call(this,t);var o=this.subName;this.service.supported().then(function(e){if(!e)switch(o){case"hidden":case"hide":t.hide();break;default:t.lock()}})}}],[{key:"getName",value:function(){return"support"}},{key:"services",value:function(){return{service:_}}}]),n}(p.Directive),ce=function(t){function n(){return u(this,n),r(this,n,arguments)}return d(n,t),l(n,[{key:"init",value:function(){h(e(n.prototype),"init",this).call(this),this.voices=[]}},{key:"allInjected",value:function(){var e=this;this.service.onVoicesChange(function(t){e.voices=t,e.getPDFUI().getCurrentLanguage().then(function(n){var o=new RegExp(n.split("|"),"i");e.selectedVoice=t.find(function(e){return e.lang.match(o)}),e.selectedVoice&&e.selectVoice(e.selectedVoice)}),e.digest()}),this.on("active",function(){0===e.voices.length&&e.service.loadVoices()})}},{key:"selectVoice",value:function(e){var t=this;this.getPDFUI().getReadAloudService().then(function(n){n.setVoice(e.name),t.selectedVoice=e,t.digest()})}}],[{key:"getName",value:function(){return"select-voice-dropdown"}},{key:"inject",value:function(){return{service:_}}}]),n}(p.SeniorComponentFactory.createSuperClass({template:'\n        <dropdown\n            separate="false"\n            align="out-right"\n            valign="top"\n            @var.self="$component"\n            text="read-aloud:read-aloud.voice.text"\n            icon-class="fx-icon-ribbon_view_read_voice-16"\n            @tooltip tooltip-title="read-aloud:read-aloud.voice.desc"\n            tooltip-description="read-aloud:read-aloud.voice.descSub"\n            class="fv__ui-read-aloud-select-voice-dropdown"\n        >\n            <xbutton @foreach="voice in self.voices track by name" @sync.active="self.selectedVoice === voice" @on.click="self.selectVoice(voice)">(@{\'lang.\' + voice.lang|i18n})@{\' \'}@{voice.name}</xbutton>\n        </dropdown>\n    '}));const de=function(e){function t(){return u(this,t),r(this,t,arguments)}return d(t,e),l(t,[{key:"init",value:function(e){this.pdfUI=e}},{key:"serviceClass",value:function(){return _}},{key:"service",value:function(){return this.pdfUI.getServiceInstance(_)}},{key:"onActivationChange",value:function(e){return this.service().onActivationChange(function(t){e(t===S.activated)})}}],[{key:"getName",value:function(){return"read-aloud"}},{key:"getLoader",value:function(){return f()}},{key:"initOnLoad",value:function(){var e=p.modular.module("read-aloud",[]);e.registerComponent(A),e.registerComponent(T),e.registerComponent(I),e.registerComponent(R),e.registerComponent(E),e.registerComponent(N),e.registerComponent(q),e.registerComponent(X),e.registerComponent(Q),e.registerComponent(Z),e.registerComponent(ne),e.registerComponent(oe),e.getRegistry().registerDirective(ae),e.getRegistry().registerDirective(le),e.getRegistry().registerDirective(ie),e.registerComponent(se),e.registerComponent(ce)}}]),t}(p.UIXAddon)})(),a=a.default})());